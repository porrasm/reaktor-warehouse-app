(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{149:function(e,t,a){},176:function(e,t,a){"use strict";a.r(t);var r=a(6),n=a(0),c=a.n(n),i=a(51),s=a.n(i),u=(a(149),a(21)),o=a.n(u),l=a(48),d=a(125),g=a(126),f=a(133),p=a(131),b=a(189),h=a(198),j=a(199),v=a(190),x=a(196),y=a(127),m=a.n(y),O=0,C=function(){var e=Object(l.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(M(["products",t]));case 2:return a=e.sent,e.abrupt("return",a||[]);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(l.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(M(["availability",t]));case 2:return a=e.sent,e.abrupt("return",a||[]);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(l.a)(o.a.mark((function e(t){var a,r,n,c,i=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=i.length>1&&void 0!==i[1]?i[1]:6,r=++O,n=0;case 3:if(!(n<a)){e.next=23;break}if(r===O){e.next=6;break}return e.abrupt("break",23);case 6:return e.prev=6,e.next=9,m.a.get(t);case 9:if(200==(c=e.sent).status){e.next=12;break}throw"Invalid response status received: "+c.status;case 12:return e.abrupt("return",c.data);case 15:e.prev=15,e.t0=e.catch(6),console.log("Error fetching JSON from API: ",e.t0.message,e.t0);case 18:return e.next=20,w(250);case 20:n++,e.next=3;break;case 23:return e.abrupt("return",null);case 24:case"end":return e.stop()}}),e,null,[[6,15]])})));return function(t){return e.apply(this,arguments)}}(),w=function(e){return new Promise((function(t){return setTimeout(t,e)}))},M=function(e){return"/api/"+e.join("/")},S={getCategoryProducts:C,getManufacturerAvailability:P},I=a(193),A=a(195),D=function(e){var t=e.product,a=e.availability;return Object(r.jsx)(I.a,{children:Object(r.jsxs)(I.a.Content,{children:[Object(r.jsx)(I.a.Header,{children:t.name}),Object(r.jsxs)(I.a.Description,{children:["Availability: ",a]}),Object(r.jsxs)(I.a.Description,{children:["Price: ",t.price]}),Object(r.jsxs)(I.a.Description,{children:["Manufacturer: ",t.manufacturer]}),Object(r.jsxs)(I.a.Description,{children:["Color: ",t.color.join(", ")]}),Object(r.jsxs)(I.a.Description,{children:["Type: ",t.type]}),Object(r.jsxs)(I.a.Description,{children:["ID: ",t.id]})]})})},E=function(e){var t=e.products,a=e.clickHandler;return Object(r.jsx)(A.a,{divided:!0,children:t.map((function(e){return Object(r.jsx)(A.a.Item,{onClick:function(){return a(e.product)},children:Object(r.jsxs)(A.a.Content,{children:[Object(r.jsx)(A.a.Header,{as:"a",children:e.product.name}),""==e.availability?"":Object(r.jsxs)(A.a.Description,{children:["Availability: ",e.availability]}),Object(r.jsxs)(A.a.Description,{children:["Price: ",e.product.price]})]})},e.product.id)}))})},F=a(132),L=a(188),T=a(177),H=a(192),J=a(35),N=a(191),R=function(e){return Object(r.jsx)(N.a,{placeholder:e.placeholder,fluid:!0,selection:!0,value:e.value,onChange:function(t,a){return e.onChange(a.value)},options:e.options.map((function(e){return{key:e,text:(t=e,t.substring(0,1).toUpperCase()+t.substring(1)),value:e};var t}))})},B=function(e){var t=Object(n.useState)(""),a=Object(F.a)(t,2),c=a[0],i=a[1];return Object(r.jsxs)("div",{children:[Object(r.jsx)(R,{placeholder:"Select category",value:e.currentCategory,onChange:e.selectCategory,options:e.categories}),Object(r.jsx)(R,{placeholder:"Select manufacturer",value:e.currentManufacturer,onChange:e.selectManufacturer,options:e.manufacturers}),"\xa0",Object(r.jsxs)(L.a,{icon:"search",style:{width:"272px"},onChange:function(e,t){return i(t.value)},children:[Object(r.jsx)("input",{}),Object(r.jsx)(T.a,{type:"submit",onClick:function(){return e.updateFilter(c)},children:"Search"})]}),"\xa0",e.pageCount>0?Object(r.jsx)(H.a,{style:{width:"272px"},boundaryRange:0,ellipsisItem:null,firstItem:null,lastItem:null,siblingRange:1,totalPages:e.pageCount,activePage:e.page+1,onPageChange:function(t,a){return e.selectPage(Number(a.activePage)-1)}}):"","\xa0",0==e.loadingMessage.length?"":Object(r.jsxs)(x.a,{icon:!0,children:[Object(r.jsx)(J.a,{name:"circle notched",loading:!0}),Object(r.jsx)(x.a.Content,{children:e.loadingMessage})]})]})},U=function(e){Object(f.a)(a,e);var t=Object(p.a)(a);function a(e){var r;Object(d.a)(this,a),(r=t.call(this,e)).pageItemCount=20,r.categories=["gloves","facemasks","beanies"],r.getCurrentCategory=function(){return r.state.products[r.state.category]},r.filterProducts=function(e){var t=r.state.page*r.pageItemCount;return console.log("In filter: ",r.state),e.filter((function(e){return console.log("In filter callback: ",r.state),r.state.manufacturer==e.manufacturer&&e.name.toLocaleLowerCase().includes(r.state.filter.toLowerCase())})).slice(t,t+r.pageItemCount)},r.getProductAvailability=function(e){if(!r.state.availability[e.manufacturer])return"";var t=r.state.availability[e.manufacturer][e.id];return t||"Error"},r.selectPage=function(e){r.setState({page:e})},r.updateFilter=function(e){r.setState({filter:e,page:0})},r.getCurrentPageCount=function(){var e=r.state.products[r.state.category];return e?Math.ceil(e.length/r.pageItemCount):0},r.selectProduct=function(){var e=Object(l.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Selected product: ",t),r.setState({selectedProduct:t});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.selectCategory=function(){var e=Object(l.a)(o.a.mark((function e(t){var a,n,c,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.state.category,!(r.state.products[t].length>0)){e.next=4;break}return r.setState({category:t,page:0}),e.abrupt("return");case 4:return r.setState({category:t,loadingMessage:"Loading products...",page:0}),console.log("Enabled category: ",t),e.next=8,S.getCategoryProducts(t);case 8:if(0!=(n=e.sent.sort((function(e,t){return e.name.localeCompare(t.name)}))).length){e.next=13;break}return window.alert("There seems to be a problem accessing the database. Please try again later."),r.setState({category:a,loadingMessage:""}),e.abrupt("return");case 13:c=n.length>0?r.getAvailableManufacturers(n)[0]:"",(i=r.state.products)[t]=n,r.setState({products:i,loadingMessage:""}),r.selectManufacturer(c);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.selectManufacturer=function(){var e=Object(l.a)(o.a.mark((function e(t){var a,n,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Selected manufacturer: ",t),""!=t){e.next=3;break}return e.abrupt("return");case 3:if(!r.state.availability[t]){e.next=7;break}return console.log("Already got information from manufacturer: ",t),r.setState({manufacturer:t,page:0}),e.abrupt("return");case 7:return r.setState({manufacturer:t,loadingMessage:"Loading stock data...",page:0}),e.next=10,S.getManufacturerAvailability(t);case 10:if(0!=(a=e.sent).length){e.next=14;break}return t===r.state.manufacturer&&window.alert("The availability data could not be accessed. There might be a problem with the database. Please try again later."),e.abrupt("return");case 14:console.log("Received availability array: ",a),n={},a.forEach((function(e){n[e.id.toLowerCase()]=e.availability})),(c=r.state.availability)[t]=n,r.setState({availability:c,loadingMessage:""});case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.getAvailableManufacturers=function(e){if(!e)return[];var t=new Set;e.forEach((function(e){t.add(e.manufacturer)}));var a=[];return t.forEach((function(e){a.push(e)})),a.sort()};var n={};return r.categories.forEach((function(e){n[e]=[]})),r.state={loadingMessage:"",category:"",manufacturer:"",selectedProduct:null,products:n,availability:{},page:0,filter:""},r}return Object(g.a)(a,[{key:"render",value:function(){var e=this;console.log("State: ",this.state);var t=this.filterProducts(this.getCurrentCategory()),a=this.getAvailableManufacturers(this.getCurrentCategory());return Object(r.jsx)("div",{children:Object(r.jsx)(b.a,{children:Object(r.jsx)(h.a,{centered:!0,columns:3,children:Object(r.jsx)(h.a.Column,{children:Object(r.jsxs)(j.a,{children:[Object(r.jsx)(E,{products:t.map((function(t){return{product:t,availability:e.getProductAvailability(t)}})),clickHandler:this.selectProduct}),Object(r.jsx)(v.a,{position:"left",children:Object(r.jsx)(B,{currentCategory:this.state.category,categories:this.categories,selectCategory:this.selectCategory,currentManufacturer:this.state.manufacturer,manufacturers:a,selectManufacturer:this.selectManufacturer,updateFilter:this.updateFilter,page:this.state.page,pageCount:this.getCurrentPageCount(),selectPage:this.selectPage,loadingMessage:this.state.loadingMessage})}),Object(r.jsx)(v.a,{position:"right",children:this.state.selectedProduct?Object(r.jsx)(D,{product:this.state.selectedProduct,availability:this.getProductAvailability(this.state.selectedProduct)}):Object(r.jsx)(x.a,{children:Object(r.jsx)(x.a.Content,{children:"Select a product for more information"})})})]})})})})})}}]),a}(c.a.Component);var q=function(){return Object(r.jsx)("div",{className:"App",children:Object(r.jsx)(U,{})})},z=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,200)).then((function(t){var a=t.getCLS,r=t.getFID,n=t.getFCP,c=t.getLCP,i=t.getTTFB;a(e),r(e),n(e),c(e),i(e)}))};a(175);s.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(q,{})}),document.getElementById("root")),z()}},[[176,1,2]]]);
//# sourceMappingURL=main.a191e995.chunk.js.map